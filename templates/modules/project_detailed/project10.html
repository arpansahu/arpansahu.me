{% extends 'base.html' %}
{% load static %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}


    <style>
    *, *:before, *:after {
      box-sizing: border-box;
    }

    pre[class*="language-"] {
      position:relative;
      overflow: auto;
      margin:5px 0;
      padding:1.75rem 0 1.75rem 1rem;
      border-radius:10px;
    }

    copy-button{
      position:absolute;
      top:5px;
      right:5px;
      font-size:.9rem;
      padding:.15rem;
      background-color:#828282;
      color: #1e1e1e;
      border:ridge 1px #7b7b7c;
      border-radius:5px;
      text-shadow:#c4c4c4 0 0 2px;
    }

    copy-button:hover{
      cursor:pointer;
       background-color:#bcbabb;
    }

    </style>
{% endblock stylesheets %}

{% block content %}

    <!-- start hero -->
    <section class="hero-one position-relative bg-black" id="about"  style="background-image: url('{% static "images/personal/main-bg.png" %}'); background-size: cover; background-position: center center;">
        <div class="container">
            <div class="row align-items-center justify-content-center py-100">
                <div class="col-lg-12 text-center py-12 text-center">
                    <h5 class="head-title py-12" aria-label="arpansahu.me"></h5>
                </div><!--end col-->
            </div><!--end row-->
        </div><!-- end container -->
    </section>
    <!-- end hero -->

    <!-- start hero -->
    <section class="hero-one position-relative bg-black" id="home"  style="background-image: url('{% static "images/personal/main-bg.png" %}'); background-size: cover; background-position: center center;">
        <div class="row align-items-center justify-content-center" style="padding: 5px; align-items: center; text-align: center">
            <h4 style="color: white">Django Portfolio Project</h4>
        </div>
        <div class="row align-items-center justify-content-center" style="padding: 5px">
            <div class="col-lg-8  mx-auto">
              <div class="col-md-8 mx-auto">
                <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-indicators">
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1" style="background-color: black"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2" style="background-color: black"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3" style="background-color: black"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4" style="background-color: black"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="4" aria-label="Slide 5" style="background-color: black"></button>
                  </div>
                  <div class="carousel-inner border-radius-sm">
                    <div class="carousel-item active">
                      <img class="d-block w-100" src="{% static 'images/sliders/project10/project10_1.png' %}" alt="First slide" />
                        <div class="carousel-caption d-none d-md-block" style="color: black">
                          <h5>About</h5>
                          <p></p>
                        </div>
                    </div>
                    <div class="carousel-item">
                      <img class="d-block w-100" src="{% static 'images/sliders/project10/project10_2.png' %}" alt="Second slide" />
                        <div class="carousel-caption d-none d-md-block" style="color: black">
                          <h5>Skills</h5>
                          <p></p>
                        </div>
                    </div>
                    <div class="carousel-item">
                      <img class="d-block w-100" src="{% static 'images/sliders/project10/project10_3.png' %}" alt="Third slide" />
                        <div class="carousel-caption d-none d-md-block" style="color: black">
                          <h5>Education and Experience</h5>
                          <p></p>
                        </div>
                    </div>
                    <div class="carousel-item">
                      <img class="d-block w-100" src="{% static 'images/sliders/project10/project10_4.png' %}" alt="Fourth slide" />
                        <div class="carousel-caption d-none d-md-block" style="color: black">
                          <h5>Projects</h5>
                          <p></p>
                        </div>
                    </div>
                    <div class="carousel-item">
                      <img class="d-block w-100" src="{% static 'images/sliders/project10/project10_5.png' %}" alt="Fifth slide" />
                        <div class="carousel-caption d-none d-md-block" style="color: black">
                          <h5>Contact</h5>
                          <p></p>
                        </div>
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon bg-success" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                    <span class="carousel-control-next-icon bg-success" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>
            </div><!--end col-->

            <div class="col-lg-4 text-center px-0 px-xl-4 mt-5 mt-lg-0 pt-5 pt-lg-0">
                <h5 class="d-inline-block py-1 px-3 rounded text-muted font-secondary" style="color: white">Technologies Used</h5>
                <span class="wrap"></span>
                <div class="mb-4 mb-lg-0">
                    <div class="d-inline-block">
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Python</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Django</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Jquery</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">HTML</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">CSS</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Bootstrap</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Javascript</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Amazon Web Services</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Mail Jet</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Heroku</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Github</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">AWS</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Nginx</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Docker</span>
                        <span class="badge badge-lg rounded bg-soft-alt-info fw-normal fs-12 text-uppercase">Jenkins</span>
                    </div>
                </div>

                <div class="mb-5 mb-lg-0" style="margin-top: 15px">
                    <a class="btn btn-block btn-social btn-github" href="https://github.com/arpansahu/arpansahu.me" target="_blank" style="color: white">
                        <span class="fa fa-github" style="margin-right: 10px; color: white"></span> Check Repo
                    </a>
                    <a class="btn btn-block btn-social btn-github" href="https://www.arpansahu.me/" target="_blank" style="color: white">
                        <span class="fa fa-youtube" style="margin-right: 10px; color: white"></span> Live Demo
                    </a>
                </div>
            </div><!--end col-->
        </div><!--end row-->
    </section>
     <!-- end hero -->
     <div class="container-fluid py-4" style="background-color: black">
        <div class="row" style="border-radius: 10px">
          <div class="col-12" style="border-radius: 10px">
            <div class="card mb-12" style="border-radius: 20px">
                <div style="padding: 20px; border-radius: 10px">
                        <h2>Description</h2><hr>
                        <p>This project is implementation for the following topics related to technologies used with Django</p><br>
                            <p>-Build Portfolio Using Bootstrap 5.</p>
                                <ol>
                                    <li>Used Bootstrap for building UI and Django as Backend.</li>
                                    <li>Used DropBox API for showing updated Resumes.</li>
                                    <li>Used Javascript / Jquery for making templates Dynamic</li>
                                    <li>Used SMTP to notify my whenever someone tries to message me on arpansahu.me</li>
                                    <li>Used AWS S3 Bucket</li>
                                    <li>Since Heroku doesn't allow to send mail using SMTP, Integrated Mail Jet</li>
                                </ol>
                            <p>-Deployed on Heroku</p>
                                <ol>
                                    <li>Used Heroku Postgres </li>
                                </ol>
                            <h2>Demo</h2><hr>
                            <p><a href="https://www.arpansahu.me/" target="_blank">Available at: https://www.arpansahu.me/</a></p>

                            <h2>License</h2><hr>
                            <p><a href="https://choosealicense.com/licenses/mit/">MIT</a></p>
                            <br>
                            <h2>Installation</h2><hr>
                            <p>Installing Pre requisites</p>

<pre><code class="language-python">pip install -r requirements.txt
</code></pre>
                            <p>Run Server.</p>
<pre><code class="language-python">python manage.py runserver
</code></pre>

                            <h2>Integrating AWS S3 Bucket</h2><hr>
                            <p>Install two python packages</p>

<pre><code class="language-python">pip install boto3
pip install django-storages
</code></pre>
                            <p>create a new file named
<pre><code class="language-python">storage_backends.py
</code></pre> with this code inside it.</p>

<pre><code class="language-python">from django.conf import settings
from storages.backends.s3boto3 import S3Boto3Storage


class StaticStorage(S3Boto3Storage):
    location = settings.AWS_STATIC_LOCATION


class PublicMediaStorage(S3Boto3Storage):
    location = settings.AWS_PUBLIC_MEDIA_LOCATION
    file_overwrite = False


class PrivateMediaStorage(S3Boto3Storage):
    location = 'private'
    default_acl = 'private'
    file_overwrite = False
    custom_domain = False
</code></pre>
                            <p>Change settings.py static files and media files settings</p>
<pre><code class="language-python">if not DEBUG:
    AWS_ACCESS_KEY_ID = config('AWS_ACCESS_KEY_ID')
    AWS_SECRET_ACCESS_KEY = config('AWS_SECRET_ACCESS_KEY')
    AWS_STORAGE_BUCKET_NAME = config('AWS_STORAGE_BUCKET_NAME')
    AWS_S3_CUSTOM_DOMAIN = f'{AWS_STORAGE_BUCKET_NAME}.s3.amazonaws.com'
    AWS_DEFAULT_ACL = 'public-read'
    AWS_S3_OBJECT_PARAMETERS = {
        'CacheControl': 'max-age=86400'
    }
    AWS_LOCATION = 'static'
    AWS_QUERYSTRING_AUTH = False
    AWS_HEADERS = {
        'Access-Control-Allow-Origin': '*',
    }
    # s3 static settings
    AWS_STATIC_LOCATION = 'portfolio/arpansahu.me/static'
    STATIC_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{AWS_STATIC_LOCATION}/'
    STATICFILES_STORAGE = 'arpansahu_dot_me.storage_backends.StaticStorage'
    # s3 public media settings
    AWS_PUBLIC_MEDIA_LOCATION = 'portfolio/arpansahu.me/media'
    MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/{AWS_PUBLIC_MEDIA_LOCATION}/'
    DEFAULT_FILE_STORAGE = 'arpansahu_dot_me.storage_backends.PublicMediaStorage'
    # s3 private media settings
    PRIVATE_MEDIA_LOCATION = 'portfolio/arpansahu.me/private'
    PRIVATE_FILE_STORAGE = 'arpansahu_dot_me.storage_backends.PrivateMediaStorage'
else:
    # Static files (CSS, JavaScript, Images)
    # https://docs.djangoproject.com/en/3.2/howto/static-files/

    STATIC_URL = '/static/'

    STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')
    MEDIA_URL = '/media/'
    MEDIA_ROOT = os.path.join(BASE_DIR, 'media')

STATICFILES_DIRS = [os.path.join(BASE_DIR, "static"), ]
</code></pre>

                            <p>run below command
<pre><code class="language-python">python manage.py collectstatic
</code></pre> and you are good to go.</p>

                            <h2>Deployment on Heroku</h2><hr>
                            <p>Installing Heroku Cli</p>
<pre><code class="language-python">checkout: https://devcenter.heroku.com/articles/heroku-cli
</code></pre>

                            <p>Create your account in Heroku.</p>
                            <p>Inside your project directory </p>
                            <p>Login Heroku CLI</p>
<pre><code class="language-python">heroku login
</code></pre>
                            <p>Create Heroku App</p>
<pre><code class="language-python">heroku create [app_name]
</code></pre>
                            <p>Push Heroku App</p>
<pre><code class="language-python">git push heroku master
</code></pre>
                            <p>Configure Heroku App Env Variables</p>
<pre><code class="language-python">heroku config:set GITHUB_USERNAME=joesmith
</code></pre>
                            <h2>Configuring Django App for Heroku</h2><hr>
                            <p>Install whitenoise </p>
<pre><code class="language-python">pip install whitenoise
</code></pre>
                            <p>Include it in Middlewares.</p>
<pre><code class="language-python">MIDDLEWARE = [
    # ...
    "django.middleware.security.SecurityMiddleware",
    "whitenoise.middleware.WhiteNoiseMiddleware",
    # ...
]
</code></pre>
                            <p>Create Procfile and include this code snippet in it.</p>
<pre><code class="language-python">web: gunicorn arpansahu_dot_me.wsgi
</code></pre>
                            <h2>Enabling HSTS if Using EC2 to host with Nginx</h2><hr>
                            <p>Add to project/settings.py</p>
<pre><code class="language-python">SECURE_HSTS_SECONDS = 30  # Unit is seconds; *USE A SMALL VALUE FOR TESTING!*
SECURE_HSTS_PRELOAD = True
SECURE_HSTS_INCLUDE_SUBDOMAINS = True
SECURE_PROXY_SSL_HEADER = ("HTTP_X_FORWARDED_PROTO", "https")
</code></pre>
                            <p># Edit your Nginx Config File</p>
<pre><code class="language-python">location / {
  proxy_pass          http://localhost:8000;
  proxy_set_header    Host $host;
  proxy_set_header    X-Forwarded-Proto $scheme;
}
</code></pre>                  
                            <h2>Also Set Referrer-policy Header</h2><hr>
                            <p>Add to project/settings.py</p>    
<pre><code class="language-python">SECURE_REFERRER_POLICY = "strict-origin-when-cross-origin"   
</code></pre>   
                            <h2>Deployment on AWS EC2/ Home Server Ubuntu 22.0 LTS</h2><hr>
                            <p>
                              Previously This project was hosted on Heroku, but so I started hosting this and all other projects in a 
                              Single EC2 Machine, which costed me a lot, so now I have shifted all the projects into my own Home Server with 
                              Ubuntu 22.0 LTS Server, except for portfolio project at https://www.arpansahu.me along with Nginx 


                              Now there is EC2 server running with a nginx server and arpansahu.me portfolio
                              Nginx forward https://arpansahu.me/ to Home Server 

                              Multiple Projects are running inside dockers so all projects are dockerized.
                              You can refer to all projects on https://www.arpansahu.me/projects

                              Every project have different port on which its running predefined inside Dockerfile and docker-compose.yml

                              <img src="{% static '/ec2_and_home_server.png' %}" alt="EC2 and Home Server along with Nginx, Docker and Jenkins Arrangement">

                              Note: Update as of Aug 2023, I have decided to make some changes to my lifestyle, and from now i will be constantly on the go
                                    from my past experience with running free EC2 server for arpansahu.me and nginx in it and then using another home server
                                    with all the other projects hosted, my experience was

                              1. Downtime due to Broadband Service Provider Issues
                              2. Downtime due to Weather Sometimes
                              3. Downtime due to Machine Breakdown
                              4. Downtime due to Power Cuts (even though i had a inverted with battery setup for my room)
                              5. Remotely it would be harder to fix these problems 

                              and due to all these reasons i decided to shift all the projects to single EC2 Server, at first i was using t2.medium which costs more than 40$ a month 
                              then i switched to t2.small and it only costs you 15$ and if we take pre paid plans prices can be slashed much further. 

                              Now My project arrangements looks something similar to this

                              <img src="{% static '/Arpan-Sahu-Dot-Me-Config-Jenkins-.png' %}" alt="EC2 Sever along with Nginx, Docker and Jenkins Arrangement">
                            </p>
                            <h2>Environment Variables</h2><hr>
                            <p>To run this project, you will need to add the following environment variables to your .env file</p>
<pre><code class="language-python">EMAIL=
  PASS=
  
  SECRET_KEY=
  DEBUG=
  ALLOWED_HOSTS=
  
  MAIL_JET_API_KEY=
  MAIL_JET_API_SECRET=
  MY_EMAIL_ADDRESS=
  
  AWS_ACCESS_KEY_ID=
  AWS_SECRET_ACCESS_KEY=
  AWS_STORAGE_BUCKET_NAME=
  
  DATABASE_URL=
  REDISCLOUD_URL=
  
  DROPBOX_ACCESS_TOKEN=
</code></pre>
                    </div>
            </div>
          </div>
        </div>
     </div>
{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
    <script>
    <!-- Copy Button JS -->
    const copyButtonLabel = "Copy Code";

    // you can use a class selector instead if you, or the syntax highlighting library adds one to the 'pre'.
    let blocks = document.querySelectorAll("pre");

    blocks.forEach((block) => {
      // only add button if browser supports Clipboard API
      if (navigator.clipboard) {
        let button = document.createElement("copy-button");
        button.innerText = copyButtonLabel;
        button.addEventListener("click", copyCode);
        block.appendChild(button);
      }
    });

    async function copyCode(event) {
      const button = event.srcElement;
      const pre = button.parentElement;
      let code = pre.querySelector("code");
      let text = code.innerText;
      await navigator.clipboard.writeText(text);

      button.innerText = "Code Copied";

      setTimeout(()=> {
        button.innerText = copyButtonLabel;
      },1000)
    }
    <!-- Copy Button JS ends-->
    </script>
{% endblock javascripts %}